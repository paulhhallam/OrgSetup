{
  "version": 4,
  "terraform_version": "0.13.0",
  "serial": 26,
  "lineage": "a069c390-fa7f-e3e0-7044-903b979feaae",
  "outputs": {
    "ConfigTableName": {
      "value": "InstanceSchedulerOrg-ConfigTable-UP3EFM1AG1OJ",
      "type": "string"
    },
    "OrgSchedule": {
      "value": {
        "AccountId": "317335576103",
        "ConfigurationTable": "InstanceSchedulerOrg-ConfigTable-UP3EFM1AG1OJ",
        "IssueSnsTopicArn": "arn:aws:sns:eu-west-2:317335576103:InstanceSchedulerOrg-InstanceSchedulerSnsTopic-G9YDQ5GXZ9IC",
        "SchedulerRoleArn": "arn:aws:iam::317335576103:role/InstanceSchedulerOrg-SchedulerRole-1D9I2S4IETZNT",
        "ServiceInstanceScheduleServiceToken": "arn:aws:lambda:eu-west-2:317335576103:function:InstanceSchedulerOrg-InstanceSchedulerMain"
      },
      "type": [
        "map",
        "string"
      ]
    }
  },
  "resources": [
    {
      "module": "module.instanceschedulerOrg",
      "mode": "managed",
      "type": "aws_cloudformation_stack",
      "name": "InstanceSchedulerOrg",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "capabilities": [
              "CAPABILITY_IAM"
            ],
            "disable_rollback": false,
            "iam_role_arn": "",
            "id": "arn:aws:cloudformation:eu-west-2:317335576103:stack/InstanceSchedulerOrg/0332e4a0-f441-11ea-8976-0a00689a5e78",
            "name": "InstanceSchedulerOrg",
            "notification_arns": null,
            "on_failure": null,
            "outputs": {
              "AccountId": "317335576103",
              "ConfigurationTable": "InstanceSchedulerOrg-ConfigTable-UP3EFM1AG1OJ",
              "IssueSnsTopicArn": "arn:aws:sns:eu-west-2:317335576103:InstanceSchedulerOrg-InstanceSchedulerSnsTopic-G9YDQ5GXZ9IC",
              "SchedulerRoleArn": "arn:aws:iam::317335576103:role/InstanceSchedulerOrg-SchedulerRole-1D9I2S4IETZNT",
              "ServiceInstanceScheduleServiceToken": "arn:aws:lambda:eu-west-2:317335576103:function:InstanceSchedulerOrg-InstanceSchedulerMain"
            },
            "parameters": {
              "CrossAccountRoles": "",
              "Regions": "eu-west-2",
              "StartedTags": "OrgStarted",
              "StoppedTags": "OrgStoped",
              "TagName": "OrgSchedule"
            },
            "policy_body": null,
            "policy_url": null,
            "tags": {},
            "template_body": "{\"AWSTemplateFormatVersion\":\"2010-09-09\",\"Description\":\"Organisation - instance-scheduler, version v1.3.2\",\"Mappings\":{\"EnabledDisabled\":{\"No\":{\"Value\":\"DISABLED\"},\"Yes\":{\"Value\":\"ENABLED\"}},\"Services\":{\"Both\":{\"Value\":\"ec2,rds\"},\"EC2\":{\"Value\":\"ec2\"},\"RDS\":{\"Value\":\"rds\"}},\"Settings\":{\"Metrics\":{\"SolutionId\":\"S00030\",\"Url\":\"https://metrics.awssolutionsbuilder.com/generic\"},\"RdsTagCaching\":{\"Enabled\":\"True\"}},\"Timeouts\":{\"1\":{\"Value\":\"cron(0/1 * * * ? *)\"},\"10\":{\"Value\":\"cron(0/10 * * * ? *)\"},\"15\":{\"Value\":\"cron(0/15 * * * ? *)\"},\"2\":{\"Value\":\"cron(0/2 * * * ? *)\"},\"30\":{\"Value\":\"cron(0/30 * * * ? *)\"},\"5\":{\"Value\":\"cron(0/5 * * * ? *)\"},\"60\":{\"Value\":\"cron(0 0/1 * * ? *)\"}},\"TrueFalse\":{\"No\":{\"Value\":\"False\"},\"Yes\":{\"Value\":\"True\"}}},\"Metadata\":{\"AWS::CloudFormation::Interface\":{\"ParameterGroups\":[{\"Label\":{\"default\":\"Scheduler (version v1.3.2)\"},\"Parameters\":[\"TagName\",\"ScheduledServices\",\"ScheduleRdsClusters\",\"CreateRdsSnapshot\",\"SchedulingActive\",\"Regions\",\"DefaultTimezone\",\"CrossAccountRoles\",\"ScheduleLambdaAccount\",\"SchedulerFrequency\",\"MemorySize\"]},{\"Label\":{\"default\":\"Options\"},\"Parameters\":[\"UseCloudWatchMetrics\",\"SendAnonymousData\",\"Trace\"]},{\"Label\":{\"default\":\"Other parameters\"},\"Parameters\":[\"LogRetentionDays\",\"StartedTags\",\"StoppedTags\"]}],\"ParameterLabels\":{\"CreateRdsSnapshot\":{\"default\":\"Create RDS instance snapshot\"},\"CrossAccountRoles\":{\"default\":\"Cross-account roles\"},\"DefaultTimezone\":{\"default\":\"Default time zone\"},\"LogRetentionDays\":{\"default\":\"Log retention days\"},\"MemorySize\":{\"default\":\"Memory size\"},\"Regions\":{\"default\":\"Region(s)\"},\"ScheduleLambdaAccount\":{\"default\":\"This account\"},\"ScheduleRdsClusters\":{\"default\":\"Schedule Aurora Clusters\"},\"ScheduledServices\":{\"default\":\"Service(s) to schedule\"},\"SchedulerFrequency\":{\"default\":\"Frequency\"},\"SchedulingActive\":{\"default\":\"Scheduling enabled\"},\"SendAnonymousData\":{\"default\":\"Send anonymous usage data\"},\"StartedTags\":{\"default\":\"Started tags\"},\"StoppedTags\":{\"default\":\"Stopped tags\"},\"TagName\":{\"default\":\"Instance Scheduler tag name\"},\"Trace\":{\"default\":\"Enable CloudWatch Logs\"},\"UseCloudWatchMetrics\":{\"default\":\"Enable CloudWatch Metrics\"}}}},\"Outputs\":{\"AccountId\":{\"Description\":\"Account to give access to when creating cross-account access role fro cross account scenario \",\"Value\":{\"Ref\":\"AWS::AccountId\"}},\"ConfigurationTable\":{\"Description\":\"Name of the DynomoDB configuration table\",\"Value\":{\"Ref\":\"ConfigTable\"}},\"IssueSnsTopicArn\":{\"Description\":\"Topic to subscribe to for notifications of errors and warnings\",\"Value\":{\"Ref\":\"InstanceSchedulerSnsTopic\"}},\"SchedulerRoleArn\":{\"Description\":\"Role for the instance scheduler lambda function\",\"Value\":{\"Fn::GetAtt\":[\"SchedulerRole\",\"Arn\"]}},\"ServiceInstanceScheduleServiceToken\":{\"Description\":\"Arn to use as ServiceToken property for custom resource type Custom::ServiceInstanceSchedule\",\"Value\":{\"Fn::GetAtt\":[\"Main\",\"Arn\"]}}},\"Parameters\":{\"CreateRdsSnapshot\":{\"AllowedValues\":[\"Yes\",\"No\"],\"Default\":\"Yes\",\"Description\":\"Create snapshot before stopping RDS instances(does not apply to Aurora Clusters).\",\"Type\":\"String\"},\"CrossAccountRoles\":{\"Description\":\"Comma separated list of ARN's for cross account access roles. These roles must be created in all checked accounts the scheduler to start and stop instances.\",\"Type\":\"CommaDelimitedList\"},\"DefaultTimezone\":{\"AllowedValues\":[\"Europe/London\",\"GMT\",\"UTC\"],\"Default\":\"UTC\",\"Description\":\"Choose the default Time Zone. Default is 'UTC'\",\"Type\":\"String\"},\"LogRetentionDays\":{\"AllowedValues\":[1,3,5,7,14,30,60,90,120,150,180,365,400,545,731,1827,3653],\"Default\":30,\"Description\":\"Retention days for scheduler logs.\",\"Type\":\"Number\"},\"MemorySize\":{\"AllowedValues\":[128,384,512,640,768,896,1024,1152,1280,1408,1536],\"Default\":128,\"Description\":\"Size of the Lambda function running the scheduler, increase size when processing large numbers of instances\",\"Type\":\"Number\"},\"Regions\":{\"Description\":\"List of regions in which instances are scheduled, leave blank for current region only.\",\"Type\":\"CommaDelimitedList\"},\"ScheduleLambdaAccount\":{\"AllowedValues\":[\"Yes\",\"No\"],\"Default\":\"Yes\",\"Description\":\"Schedule instances in this account.\",\"Type\":\"String\"},\"ScheduleRdsClusters\":{\"AllowedValues\":[\"Yes\",\"No\"],\"Default\":\"No\",\"Description\":\"Enable scheduling of Aurora clusters for RDS Service.\",\"Type\":\"String\"},\"ScheduledServices\":{\"AllowedValues\":[\"EC2\",\"RDS\",\"Both\"],\"Default\":\"EC2\",\"Description\":\"Scheduled Services.\",\"Type\":\"String\"},\"SchedulerFrequency\":{\"AllowedValues\":[\"1\",\"2\",\"5\",\"10\",\"15\",\"30\",\"60\"],\"Default\":\"5\",\"Description\":\"Scheduler running frequency in minutes.\",\"Type\":\"String\"},\"SchedulingActive\":{\"AllowedValues\":[\"Yes\",\"No\"],\"Default\":\"Yes\",\"Description\":\"Activate or deactivate scheduling.\",\"Type\":\"String\"},\"SendAnonymousData\":{\"AllowedValues\":[\"Yes\",\"No\"],\"Default\":\"Yes\",\"Description\":\"Send Anonymous Metrics Data.\",\"Type\":\"String\"},\"StartedTags\":{\"Description\":\"Comma separated list of tagname and values on the formt name=value,name=value,.. that are set on started instances\",\"Type\":\"String\"},\"StoppedTags\":{\"Description\":\"Comma separated list of tagname and values on the formt name=value,name=value,.. that are set on stopped instances\",\"Type\":\"String\"},\"TagName\":{\"Default\":\"Schedule\",\"Description\":\"Name of tag to use for associating instance schedule schemas with service instances.\",\"MaxLength\":127,\"MinLength\":1,\"Type\":\"String\"},\"Trace\":{\"AllowedValues\":[\"Yes\",\"No\"],\"Default\":\"No\",\"Description\":\"Enable logging of detailed informtion in CloudWatch logs.\",\"Type\":\"String\"},\"UseCloudWatchMetrics\":{\"AllowedValues\":[\"Yes\",\"No\"],\"Default\":\"No\",\"Description\":\"Collect instance scheduling data using CloudWatch metrics.\",\"Type\":\"String\"}},\"Resources\":{\"ConfigTable\":{\"Properties\":{\"AttributeDefinitions\":[{\"AttributeName\":\"type\",\"AttributeType\":\"S\"},{\"AttributeName\":\"name\",\"AttributeType\":\"S\"}],\"BillingMode\":\"PAY_PER_REQUEST\",\"KeySchema\":[{\"AttributeName\":\"type\",\"KeyType\":\"HASH\"},{\"AttributeName\":\"name\",\"KeyType\":\"RANGE\"}],\"SSESpecification\":{\"KMSMasterKeyId\":{\"Ref\":\"InstanceSchedulerEncryptionKey\"},\"SSEEnabled\":\"True\",\"SSEType\":\"KMS\"},\"Tags\":[{\"Key\":\"cloudformation:stack-name\",\"Value\":\"OrgInstanceScheduler\"}]},\"Type\":\"AWS::DynamoDB::Table\"},\"EC2DynamoDBPolicy\":{\"Metadata\":{\"cfn_nag\":{\"rules_to_suppress\":[{\"id\":\"W12\",\"reason\":\"All policies have been scoped to be as restrictive as possible. This solution needs to access ec2/rds resources across all regions.\"}]}},\"Properties\":{\"PolicyDocument\":{\"Statement\":[{\"Action\":[\"dynamodb:DeleteItem\",\"dynamodb:GetItem\",\"dynamodb:PutItem\",\"dynamodb:Query\",\"dynamodb:Scan\",\"dynamodb:BatchWriteItem\"],\"Effect\":\"Allow\",\"Resource\":[{\"Fn::Join\":[\"\",[{\"Fn::Join\":[\":\",[\"arn:aws:dynamodb\",{\"Ref\":\"AWS::Region\"},{\"Ref\":\"AWS::AccountId\"},\"table/\"]]},{\"Ref\":\"StateTable\"}]]},{\"Fn::Join\":[\"\",[{\"Fn::Join\":[\":\",[\"arn:aws:dynamodb\",{\"Ref\":\"AWS::Region\"},{\"Ref\":\"AWS::AccountId\"},\"table/\"]]},{\"Ref\":\"ConfigTable\"}]]},{\"Fn::Join\":[\"\",[{\"Fn::Join\":[\":\",[\"arn:aws:dynamodb\",{\"Ref\":\"AWS::Region\"},{\"Ref\":\"AWS::AccountId\"},\"table/\"]]},{\"Ref\":\"MaintenanceWindowTable\"}]]}]},{\"Action\":[\"logs:CreateLogGroup\",\"logs:CreateLogStream\",\"logs:PutLogEvents\",\"logs:PutRetentionPolicy\"],\"Effect\":\"Allow\",\"Resource\":[{\"Fn::Join\":[\":\",[\"arn:aws:logs\",{\"Ref\":\"AWS::Region\"},{\"Ref\":\"AWS::AccountId\"},\"log-group\",{\"Ref\":\"SchedulerLogGroup\"},\"*\"]]},{\"Fn::Join\":[\":\",[\"arn:aws:logs\",{\"Ref\":\"AWS::Region\"},{\"Ref\":\"AWS::AccountId\"},\"log-group:/aws/lambda/*\"]]}]},{\"Action\":[\"logs:DescribeLogStreams\",\"rds:DescribeDBClusters\",\"rds:DescribeDBInstances\",\"ec2:DescribeInstances\",\"ec2:DescribeRegions\",\"ec2:ModifyInstanceAttribute\",\"cloudwatch:PutMetricData\",\"ssm:DescribeMaintenanceWindows\",\"tag:GetResources\"],\"Effect\":\"Allow\",\"Resource\":[\"*\"]},{\"Action\":[\"sts:AssumeRole\"],\"Effect\":\"Allow\",\"Resource\":[\"arn:aws:iam::*:role/*EC2SchedulerCross*\"]},{\"Action\":[\"ssm:GetParameter\",\"ssm:GetParameters\"],\"Effect\":\"Allow\",\"Resource\":{\"Fn::Join\":[\":\",[\"arn:aws:ssm:*\",{\"Ref\":\"AWS::AccountId\"},\"parameter/*\"]]}}],\"Version\":\"2012-10-17\"},\"PolicyName\":\"EC2DynamoDBPolicy\",\"Roles\":[{\"Ref\":\"SchedulerRole\"}]},\"Type\":\"AWS::IAM::Policy\"},\"InstanceSchedulerEncryptionKey\":{\"Properties\":{\"Description\":\"Key for SNS\",\"EnableKeyRotation\":true,\"Enabled\":true,\"KeyPolicy\":{\"Statement\":[{\"Action\":\"kms:*\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":{\"Fn::Sub\":\"arn:${AWS::Partition}:iam::${AWS::AccountId}:root\"}},\"Resource\":\"*\",\"Sid\":\"default\"},{\"Action\":[\"kms:GenerateDataKey*\",\"kms:Decrypt\"],\"Effect\":\"Allow\",\"Principal\":{\"AWS\":{\"Fn::GetAtt\":[\"SchedulerRole\",\"Arn\"]}},\"Resource\":\"*\",\"Sid\":\"Allows use of key\"}]},\"Tags\":[{\"Key\":\"cloudformation:stack-name\",\"Value\":\"OrgInstanceScheduler\"}]},\"Type\":\"AWS::KMS::Key\"},\"InstanceSchedulerEncryptionKeyAlias\":{\"Properties\":{\"AliasName\":\"alias/instance-scheduler-encryption-key\",\"TargetKeyId\":{\"Ref\":\"InstanceSchedulerEncryptionKey\"}},\"Type\":\"AWS::KMS::Alias\"},\"InstanceSchedulerSnsTopic\":{\"Properties\":{\"DisplayName\":{\"Ref\":\"AWS::StackName\"},\"KmsMasterKeyId\":{\"Ref\":\"InstanceSchedulerEncryptionKey\"},\"Tags\":[{\"Key\":\"cloudformation:stack-name\",\"Value\":\"OrgInstanceScheduler\"}]},\"Type\":\"AWS::SNS::Topic\"},\"Main\":{\"DependsOn\":[\"SchedulerPolicy\",\"EC2DynamoDBPolicy\"],\"Metadata\":{\"cfn_nag\":{\"rules_to_suppress\":[{\"id\":\"W58\",\"reason\":\"All policies have been scoped to be as restrictive as possible. This lambda function has access to write logs.\"}]}},\"Properties\":{\"Code\":{\"S3Bucket\":{\"Fn::Join\":[\"-\",[\"solutions\",{\"Ref\":\"AWS::Region\"}]]},\"S3Key\":\"aws-instance-scheduler/v1.3.2/instance-scheduler.zip\"},\"Description\":\"EC2 and RDS instance scheduler, version v1.3.2\",\"Environment\":{\"Variables\":{\"ACCOUNT\":{\"Ref\":\"AWS::AccountId\"},\"BOTO_RETRY\":\"5,10,30,0.25\",\"CONFIG_TABLE\":{\"Ref\":\"ConfigTable\"},\"ENV_BOTO_RETRY_LOGGING\":\"False\",\"ISSUES_TOPIC_ARN\":{\"Ref\":\"InstanceSchedulerSnsTopic\"},\"LOG_GROUP\":{\"Ref\":\"SchedulerLogGroup\"},\"MAINTENANCE_WINDOW_TABLE\":{\"Ref\":\"MaintenanceWindowTable\"},\"METRICS_URL\":{\"Fn::FindInMap\":[\"Settings\",\"Metrics\",\"Url\"]},\"SCHEDULER_FREQUENCY\":{\"Ref\":\"SchedulerFrequency\"},\"SCHEDULER_RULE\":{\"Ref\":\"SchedulerRule\"},\"SEND_METRICS\":{\"Fn::FindInMap\":[\"TrueFalse\",{\"Ref\":\"SendAnonymousData\"},\"Value\"]},\"SOLUTION_ID\":{\"Fn::FindInMap\":[\"Settings\",\"Metrics\",\"SolutionId\"]},\"STACK_NAME\":{\"Ref\":\"AWS::StackName\"},\"STATE_TABLE\":{\"Ref\":\"StateTable\"},\"TAG_NAME\":{\"Ref\":\"TagName\"},\"TRACE\":{\"Fn::FindInMap\":[\"TrueFalse\",{\"Ref\":\"Trace\"},\"Value\"]},\"USER_AGENT\":{\"Fn::Join\":[\"-\",[\"InstanceScheduler\",{\"Ref\":\"AWS::StackName\"},\"v1.3.2\"]]}}},\"FunctionName\":{\"Fn::Join\":[\"-\",[{\"Ref\":\"AWS::StackName\"},\"InstanceSchedulerMain\"]]},\"Handler\":\"main.lambda_handler\",\"MemorySize\":{\"Ref\":\"MemorySize\"},\"Role\":{\"Fn::GetAtt\":[\"SchedulerRole\",\"Arn\"]},\"Runtime\":\"python3.7\",\"Timeout\":300},\"Type\":\"AWS::Lambda::Function\"},\"MaintenanceWindowTable\":{\"Properties\":{\"AttributeDefinitions\":[{\"AttributeName\":\"Name\",\"AttributeType\":\"S\"}],\"BillingMode\":\"PAY_PER_REQUEST\",\"KeySchema\":[{\"AttributeName\":\"Name\",\"KeyType\":\"HASH\"}],\"SSESpecification\":{\"KMSMasterKeyId\":{\"Ref\":\"InstanceSchedulerEncryptionKey\"},\"SSEEnabled\":\"True\",\"SSEType\":\"KMS\"},\"Tags\":[{\"Key\":\"cloudformation:stack-name\",\"Value\":\"OrgInstanceScheduler\"}],\"TimeToLiveSpecification\":{\"AttributeName\":\"TimeToLive\",\"Enabled\":\"TRUE\"}},\"Type\":\"AWS::DynamoDB::Table\"},\"SchedulerConfigHelper\":{\"DependsOn\":[\"SchedulerLogGroup\"],\"Properties\":{\"ServiceToken\":{\"Fn::GetAtt\":[\"Main\",\"Arn\"]},\"config_table\":{\"Ref\":\"ConfigTable\"},\"create_rds_snapshot\":{\"Fn::FindInMap\":[\"TrueFalse\",{\"Ref\":\"CreateRdsSnapshot\"},\"Value\"]},\"cross_account_roles\":{\"Ref\":\"CrossAccountRoles\"},\"default_timezone\":{\"Ref\":\"DefaultTimezone\"},\"log_retention_days\":{\"Ref\":\"LogRetentionDays\"},\"regions\":{\"Ref\":\"Regions\"},\"schedule_clusters\":{\"Fn::FindInMap\":[\"TrueFalse\",{\"Ref\":\"ScheduleRdsClusters\"},\"Value\"]},\"schedule_lambda_account\":{\"Fn::FindInMap\":[\"TrueFalse\",{\"Ref\":\"ScheduleLambdaAccount\"},\"Value\"]},\"scheduled_services\":{\"Fn::Split\":[\",\",{\"Fn::FindInMap\":[\"Services\",{\"Ref\":\"ScheduledServices\"},\"Value\"]}]},\"stack_version\":\"v1.3.2\",\"started_tags\":{\"Ref\":\"StartedTags\"},\"stopped_tags\":{\"Ref\":\"StoppedTags\"},\"tagname\":{\"Ref\":\"TagName\"},\"timeout\":\"120\",\"trace\":{\"Fn::FindInMap\":[\"TrueFalse\",{\"Ref\":\"Trace\"},\"Value\"]},\"use_metrics\":{\"Fn::FindInMap\":[\"TrueFalse\",{\"Ref\":\"UseCloudWatchMetrics\"},\"Value\"]}},\"Type\":\"Custom::ServiceSetup\"},\"SchedulerInvokePermission\":{\"DependsOn\":\"Main\",\"Properties\":{\"Action\":\"lambda:InvokeFunction\",\"FunctionName\":{\"Fn::Join\":[\":\",[\"arn:aws:lambda\",{\"Ref\":\"AWS::Region\"},{\"Ref\":\"AWS::AccountId\"},\"function\",{\"Fn::Join\":[\"-\",[{\"Ref\":\"AWS::StackName\"},\"InstanceSchedulerMain\"]]}]]},\"Principal\":\"events.amazonaws.com\",\"SourceArn\":{\"Fn::GetAtt\":[\"SchedulerRule\",\"Arn\"]}},\"Type\":\"AWS::Lambda::Permission\"},\"SchedulerLogGroup\":{\"Properties\":{\"LogGroupName\":{\"Fn::Join\":[\"-\",[{\"Ref\":\"AWS::StackName\"},\"logs\"]]},\"RetentionInDays\":{\"Ref\":\"LogRetentionDays\"}},\"Type\":\"AWS::Logs::LogGroup\"},\"SchedulerPolicy\":{\"Metadata\":{\"cfn_nag\":{\"rules_to_suppress\":[{\"id\":\"W12\",\"reason\":\"All policies have been scoped to be as restrictive as possible. This solution needs to access ec2/rds resources across all regions.\"}]}},\"Properties\":{\"PolicyDocument\":{\"Statement\":[{\"Action\":[\"rds:DeleteDBSnapshot\",\"rds:DescribeDBSnapshots\",\"rds:StopDBInstance\"],\"Effect\":\"Allow\",\"Resource\":{\"Fn::Join\":[\":\",[\"arn:aws:rds:*\",{\"Ref\":\"AWS::AccountId\"},\"snapshot:*\"]]}},{\"Action\":[\"rds:AddTagsToResource\",\"rds:RemoveTagsFromResource\",\"rds:DescribeDBSnapshots\",\"rds:StartDBInstance\",\"rds:StopDBInstance\"],\"Effect\":\"Allow\",\"Resource\":{\"Fn::Join\":[\":\",[\"arn:aws:rds:*\",{\"Ref\":\"AWS::AccountId\"},\"db:*\"]]}},{\"Action\":[\"rds:AddTagsToResource\",\"rds:RemoveTagsFromResource\",\"rds:StartDBCluster\",\"rds:StopDBCluster\"],\"Effect\":\"Allow\",\"Resource\":[{\"Fn::Join\":[\":\",[\"arn:aws:rds:*\",{\"Ref\":\"AWS::AccountId\"},\"cluster:*\"]]}]},{\"Action\":[\"ec2:StartInstances\",\"ec2:StopInstances\",\"ec2:CreateTags\",\"ec2:DeleteTags\"],\"Effect\":\"Allow\",\"Resource\":[{\"Fn::Join\":[\":\",[\"arn:aws:ec2:*\",{\"Ref\":\"AWS::AccountId\"},\"instance/*\"]]}]},{\"Action\":\"sns:Publish\",\"Effect\":\"Allow\",\"Resource\":[{\"Ref\":\"InstanceSchedulerSnsTopic\"}]},{\"Action\":[\"lambda:InvokeFunction\"],\"Effect\":\"Allow\",\"Resource\":[{\"Fn::Join\":[\":\",[\"arn:aws:lambda\",{\"Ref\":\"AWS::Region\"},{\"Ref\":\"AWS::AccountId\"},\"function\",{\"Fn::Join\":[\"-\",[{\"Ref\":\"AWS::StackName\"},\"InstanceSchedulerMain\"]]}]]}]},{\"Action\":[\"kms:GenerateDataKey*\",\"kms:Decrypt\"],\"Effect\":\"Allow\",\"Resource\":[{\"Fn::GetAtt\":[\"InstanceSchedulerEncryptionKey\",\"Arn\"]}]}],\"Version\":\"2012-10-17\"},\"PolicyName\":\"SchedulerPolicy\",\"Roles\":[{\"Ref\":\"SchedulerRole\"}]},\"Type\":\"AWS::IAM::Policy\"},\"SchedulerRole\":{\"Properties\":{\"AssumeRolePolicyDocument\":{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"}},{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"events.amazonaws.com\"}}],\"Version\":\"2012-10-17\"},\"Path\":\"/\",\"Tags\":[{\"Key\":\"cloudformation:stack-name\",\"Value\":\"OrgInstanceScheduler\"}]},\"Type\":\"AWS::IAM::Role\"},\"SchedulerRule\":{\"Properties\":{\"Description\":\"Instance Scheduler - Rule to trigger instance for scheduler function version v1.3.2\",\"ScheduleExpression\":{\"Fn::FindInMap\":[\"Timeouts\",{\"Ref\":\"SchedulerFrequency\"},\"Value\"]},\"State\":{\"Fn::FindInMap\":[\"EnabledDisabled\",{\"Ref\":\"SchedulingActive\"},\"Value\"]},\"Targets\":[{\"Arn\":{\"Fn::Join\":[\":\",[\"arn:aws:lambda\",{\"Ref\":\"AWS::Region\"},{\"Ref\":\"AWS::AccountId\"},\"function\",{\"Fn::Join\":[\"-\",[{\"Ref\":\"AWS::StackName\"},\"InstanceSchedulerMain\"]]}]]},\"Id\":\"MainFunction\"}]},\"Type\":\"AWS::Events::Rule\"},\"StateTable\":{\"Properties\":{\"AttributeDefinitions\":[{\"AttributeName\":\"service\",\"AttributeType\":\"S\"},{\"AttributeName\":\"account-region\",\"AttributeType\":\"S\"}],\"BillingMode\":\"PAY_PER_REQUEST\",\"KeySchema\":[{\"AttributeName\":\"service\",\"KeyType\":\"HASH\"},{\"AttributeName\":\"account-region\",\"KeyType\":\"RANGE\"}],\"SSESpecification\":{\"KMSMasterKeyId\":{\"Ref\":\"InstanceSchedulerEncryptionKey\"},\"SSEEnabled\":\"True\",\"SSEType\":\"KMS\"},\"Tags\":[{\"Key\":\"cloudformation:stack-name\",\"Value\":\"OrgInstanceScheduler\"}]},\"Type\":\"AWS::DynamoDB::Table\"}}}",
            "template_url": null,
            "timeout_in_minutes": null,
            "timeouts": null
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInVwZGF0ZSI6MTgwMDAwMDAwMDAwMH19"
        }
      ]
    }
  ]
}
